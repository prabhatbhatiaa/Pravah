<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pravah | Risk Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
    
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/dashboard.css">
</head>
<body>

    <nav class="navbar">
        <div class="container nav-content">
            <div class="brand-group">
                <a href="index.html" style="text-decoration: none; display: flex; align-items: center; gap: 12px; color: inherit;">
                    <div class="brand-logo">
                        <i class="ri-drop-fill"></i>
                    </div>
                    <div class="brand-text">
                        <div class="main-title">Pravah</div>
                        <div class="sub-title">Water Logging Risk Monitoring System</div>
                    </div>
                </a>
            </div>
            <div class="nav-links">
                <button class="btn-ghost" onclick="ThemeSystem.toggle()" style="margin-right: 1rem;" aria-label="Toggle Theme">
                    <i class="ri-sun-line" id="theme-icon" style="font-size: 1.2rem;"></i>
                </button>

                <a href="about.html" class="nav-link">
                    <i class="ri-file-paper-fill"></i> About Us
                </a>
                <a href="" class="nav-link">
                    <i class="ri-phone-line"></i> Contact Us
                </a>
            </div>
        </div>
    </nav>

    <div class="dashboard-header">
        <div class="live-tag">
            <div class="live-pulse"></div> Live Monitoring
        </div>
        <h1 class="page-title">Water-Logging Risk Dashboard</h1>
        <p class="page-subtitle">Real-time ward-level risk assessment and citizen reporting</p>
    </div>

    <div class="stats-container">
        <div class="stat-card card-blue">
            <div class="stat-icon"><i class="ri-map-pin-line"></i></div>
            <div class="stat-label">Total Wards</div>
            <div class="stat-value">250</div>
            <div class="stat-sub">Under monitoring</div>
        </div>
        <div class="stat-card card-red">
            <div class="stat-icon"><i class="ri-alarm-warning-line"></i></div>
            <div class="stat-label">High Risk</div>
            <div class="stat-value" id="highRiskCount" style="color: #f87171;">--</div>
            <div class="stat-sub">Immediate attention</div>
            <div class="alert-badge">! Alert</div>
        </div>
        <div class="stat-card card-yellow">
            <div class="stat-icon"><i class="ri-drizzle-line"></i></div>
            <div class="stat-label">Medium Risk</div>
            <div class="stat-value" id="medRiskCount" style="color: #fbbf24;">--</div>
            <div class="stat-sub">Elevated risk</div>
        </div>
        <div class="stat-card card-orange">
            <div class="stat-icon"><i class="ri-time-line"></i></div>
            <div class="stat-label">Predicted Flooding</div>
            <div class="stat-value" id="predictedCount" style="color: #fb923c;">--</div>
            <div class="stat-sub">Next 24 hours</div>
        </div>
    </div>

    <div class="main-grid">
        <div class="map-wrapper">
            <div id="map"></div>
            <div id="mapLoader" class="map-loader">
                <i class="ri-loader-4-line" style="margin-right: 8px; animation: spin 1s linear infinite;"></i> Loading Wards...
            </div>
            
            <div class="map-legend-overlay">
                <div style="font-size: 0.75rem; color: var(--text-muted); margin-bottom: 6px; font-weight: 600;">RISK LEVEL</div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-main); margin-bottom: 4px;">
                    <span style="width: 8px; height: 8px; background: #ef4444; border-radius: 50%;"></span> High
                </div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-main); margin-bottom: 4px;">
                    <span style="width: 8px; height: 8px; background: #f59e0b; border-radius: 50%;"></span> Medium
                </div>
                <div style="display: flex; align-items: center; gap: 8px; font-size: 0.8rem; color: var(--text-main);">
                    <span style="width: 8px; height: 8px; background: #22c55e; border-radius: 50%;"></span> Low
                </div>
            </div>
        </div>

        <div class="sidebar-col">
            
            <div class="report-card">
                <div class="card-header-group">
                    <div class="card-icon-circle"><i class="ri-edit-line"></i></div>
                    <div>
                        <h3 style="font-size: 1rem; color: var(--text-main); font-weight: 600;">Report Water-Logging</h3>
                        <p style="font-size: 0.8rem; color: var(--text-muted);">Submit a complaint for your area</p>
                    </div>
                </div>

                <form id="complaintForm">
                    <label class="form-label">Ward *</label>
                    <select id="wardSelect" class="custom-select" required>
                        <option value="">Select your ward</option>
                    </select>

                    <label class="form-label">Severity *</label>
                    <div class="severity-options">
                        <label class="sev-label">
                            <input type="radio" name="severity" value="Low" required> Low
                        </label>
                        <label class="sev-label">
                            <input type="radio" name="severity" value="Medium"> Med
                        </label>
                        <label class="sev-label">
                            <input type="radio" name="severity" value="High"> High
                        </label>
                    </div>

                    <label class="form-label">Description (Optional)</label>
                    <textarea id="description" class="custom-textarea" rows="2" placeholder="Describe the situation..."></textarea>
                    
                    <button type="submit" class="btn-submit">
                        Submit Complaint <i class="ri-send-plane-fill"></i>
                    </button>
                </form>
            </div>

            <div class="stats-list-card">
                <div style="display: flex; align-items: center; gap: 4px; margin-bottom: 0.1rem; padding-bottom: 0.1rem; border-bottom: 1px solid var(--border);">
                    <i class="ri-bar-chart-box-line" style="color: #14b8a6;"></i>
                    <h3 style="font-size: 0.95rem; color: var(--text-main); font-weight: 600;">Quick Statistics</h3>
                </div>
                
                <div class="stats-scroll-container">
                    <div id="wardList">
                        <div class="quick-stat-row">
                            <span style="color: var(--text-muted);">Low Risk Wards</span>
                            <span style="color: #4ade80; font-weight: 300;">Loading...</span>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 0.25rem; padding-top: 0.5rem; border-top: 1px solid var(--border); font-size: 0.65rem; color: var(--text-muted); text-align: right;">
                    Last updated: <span id="lastUpdated">Just now</span>
                </div>
            </div>
        </div>
    </div>

    <div style="height: 0.1rem;"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="js/common.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/complaints.js"></script>
    
    <style>@keyframes spin { 100% { transform: rotate(360deg); } }</style>
</body>
</html>